---
title: Azure 开发流程
description: 概述了 Azure 上的云开发周期，包括预配、编码、测试、部署和管理。
ms.date: 06/04/2020
ms.topic: conceptual
ms.openlocfilehash: 644cafc60619a1920e256c4c4f32f1b3308caa83
ms.sourcegitcommit: 499f7275446f006fa43c4eff3b1f0d001e9a98d9
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/05/2020
ms.locfileid: "84453738"
---
# <a name="the-azure-development-flow-provision-code-test-deploy-and-manage"></a>Azure 开发流：预配、编码、测试、部署和管理

[上一篇文章：预配、访问和管理资源](cloud-development-provisioning.md)

至此，你已了解 Azure 的服务和资源模型。现在可以了解使用 Azure 开发云应用的整个流：预配、编码、测试、部署和管理。

| 步骤 | 主要工具 | 活动 |
| --- | --- | --- |
| 预配 | Azure CLI、Azure 门户、Cloud Shell、使用 Azure 管理库的 Python 脚本 | 预配资源组；预配这些组中的特定资源；预配资源以准备好在应用程序代码中使用和/或准备好在部署中接收 Python 代码。 |
| 代码 | 代码编辑器（如 Visual Studio Code）、Azure 库、参考文档 | 使用 Azure 客户端库编写 Python 代码，以与预配的资源进行交互。 |
| 测试 | Python 运行时、调试器 | 针对活动的云资源（通常为开发或测试资源，而不是生产资源）在本地运行 Python 代码。 代码本身尚未托管在 Azure 上，这有助于快速调试和迭代。 |
| 部署 | Azure CLI、GitHub、DevOps | 在本地测试代码后，将其部署到相应的 Azure 托管服务，在该服务中，代码本身可以在云中运行。 部署的代码通常针对过渡或生产资源运行。 |
| 管理 | Azure CLI、Azure 门户、Python 脚本、Azure Monitor | 监视应用性能和响应能力，在生产环境中进行调整，将改进迁移回开发环境以进行下一轮预配和开发。 |

## <a name="step-1-provision-and-configure-resources"></a>步骤 1：预配和配置资源

如[本系列的上一篇文章](cloud-development-provisioning.md)中所述，开发任何应用的第一步都是预配和配置组成应用目标环境的资源。

若要预配资源，请先在合适的 Azure 区域中创建资源组。 可以通过 Azure 门户、通过 Azure CLI 或采用一个使用 Azure 库（或 REST API）的自定义脚本来创建资源组。

然后，在此资源组中，同样也可以使用门户、CLI 或 Azure 库预配和配置所需的各个资源。 配置包括设置访问策略，以控制哪些标识（服务主体和/或应用 ID）能够访问这些资源。

对于大多数应用程序方案，你可能会通过 Azure CLI 和/或使用 Azure 库的 Python 代码来创建预配脚本。 此类脚本描述了应用程序的全部资源需求。 使用脚本可以轻松地在不同开发、测试、过渡和生产环境中重新创建同一组资源，而不是在 Azure 门户中手动执行许多重复步骤。 利用此类脚本，还可以轻松地在不同的区域中预配环境，或使用不同的资源组。 也可以在源代码管理存储库中维护这些脚本，以便拥有完整的审核和更改历史记录。

## <a name="step-2-write-your-app-code-to-use-resources"></a>步骤 2：编写应用代码来使用资源

预配应用所需的资源后，就可以编写应用代码来使用这些资源（将代码本身部署到其中的资源除外）。

例如，在预配步骤中，你可能已创建 Azure 存储帐户，在此帐户中创建了 Blob 容器，并为此容器中的应用设置了访问策略。 现在，在代码中，可以对此存储帐户进行身份验证，然后在此容器中创建、更新或删除 Blob。 （[示例 - 使用 Azure 存储](azure-sdk-example-storage.md)中展示了此过程）同样，你可能已预配具有架构和适当权限的数据库，以便应用代码可以连接到数据库，并执行常规的创建-读取-更新-删除操作。

应用代码通常使用环境变量来标识要使用的资源的名称和 URL。 使用环境变量可以在云环境（开发、测试、过渡和生产）之间轻松切换，而无需对代码进行任何更改。

作为 Python 开发人员，你可能会在 Python 中使用用于 Python 的 Azure 库来编写应用程序代码。 也就是说，可以使用任意受支持的语言来编写云应用的任何独立部分。 例如，如果你在具备各种语言专业知识的团队中工作，完全有可能出现下面这种情况：应用的一些部分是用 Python 编写，一些部分是用 JavaScript 编写，一些部分是用 Java 编写，另一些部分是用 C# 编写。

请注意，应用程序代码可以根据需要使用 Azure 库来执行预配和管理操作。 同样，预配脚本可以使用这些库通过特定数据来初始化资源，或者对云资源执行保养工作任务，即使那些脚本是在本地运行也无妨。

## <a name="step-3-test-and-debug-your-app-code-locally"></a>步骤 3：在本地测试和调试应用代码

开发人员通常希望先在本地工作站中测试应用代码，再将应用代码部署到云中。在本地测试应用代码意味着通常要访问你已在云中预配的其他资源（如存储、数据库等）。 不同之处在于，你还没有在云服务中运行应用代码本身。

通过在本地运行代码，还可以充分利用 Visual Studio Code 等工具提供的调试功能，并在源代码管理存储库中管理代码。

对于本地测试，根本不需要修改代码：Azure 完全支持使用与部署到云中相同的代码进行本地开发和调试。 环境变量仍然是关键：在云中，代码可以访问托管资源的设置作为环境变量。 通过在本地创建这些相同的环境变量，无需修改即可运行相同的代码。 此模式适用于身份验证凭据、资源 URL、连接字符串和任意数量的其他设置，这样可以在本地运行代码时轻松地使用开发环境中的资源，并在将代码部署到云后轻松使用生产资源。

## <a name="step-4-deploy-your-app-code-to-azure"></a>步骤 4：将应用代码部署到 Azure

在本地测试完代码后，就可以将代码部署到你已预配为托管代码的 Azure 资源。 例如，若要编写 Django Web 应用，可以将相应代码部署到虚拟机（在其中提供你自己的 Web 服务器），也可以部署到 Azure 应用服务（它为你提供 Web 服务器）。 部署完成后，此代码就会在服务器上运行，而不是在本地计算机上运行，并能访问其已获授权的所有 Azure 资源。

如上一部分所述，在典型的开发过程中，首先要将代码部署到你已在开发环境中预配的资源。 经过一轮测试后，你将代码部署到过渡环境中的资源，这样应用就可供测试团队使用，并可能对预览客户可用。 对应用的性能感到满意后，就可以将代码部署到生产环境。 所有这些部署也可以通过使用 Azure DevOps 进行的持续集成和持续部署来实现自动化。

无论采用哪种方式，一旦代码部署到云中后，它就会真正成为云应用，完全在 Azure 数据中心内的服务器计算机上运行。

## <a name="step-5-manage-monitor-and-revise"></a>步骤 5：管理、监视和修订

部署后，你需要确保应用能够正常运行，不仅能响应客户请求，还能高效地（以最低成本）使用资源。 可以对 Azure 根据需要自动缩放部署的方式进行管理，并且可以通过 Azure 门户、Azure CLI 或使用 Azure 库编写的自定义脚本来收集和监视性能数据。 然后，可以对预配的资源进行实时调整，从而优化性能，同样也可以使用相同的工具。

通过监视，可以获得有关如何重新构建云应用的见解。 例如，你可能会发现，与主要部分相比，Web 应用的某些部分（如一组 API 终结点）只是偶尔使用。 然后，可以选择将这些 API 单独部署为无服务器 Azure 函数，它们有自己的后备计算资源，这些资源不会与主应用竞争，但每月的成本非常低。 这样，主应用就可以更快地响应更多的客户，而不必纵向扩展到更高的成本层。

## <a name="next-steps"></a>后续步骤

现在，你已经熟悉了 Azure 的基本结构和整个开发流：预配资源，编写和测试代码，将代码部署到 Azure，然后监视和管理这些资源。

下一步是熟悉用于 Python 的 Azure 库，你将在该流的许多部分使用这些库。

> [!div class="nextstepaction"]
> [了解如何使用用于 Python 的 Azure 库 >>>](azure-sdk-overview.md)
